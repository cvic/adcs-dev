---
import { useTranslations, type Lang } from "@/i18n";
import { getRelativeLocaleUrl } from "astro:i18n";

import SelectCounties from "./SelectCounties.astro";
import AndDivider from "./AndDivider.astro";
import GeoLocation from "./GeoLocation.astro";
import Details from "./Details.astro";
import TermsAndConditions from "./TermsAndConditions.astro";

const t = useTranslations(Astro.currentLocale as Lang);
const locale = Astro.currentLocale as Lang;
---

<div class="more_info_container accordion hidden" id="hiddenComponent">
  <p class="more_info">
    {
      t({
        en: "This page is for those who need help from the community â€” the response is **not guaranteed**",
        ro: "AceastÄƒ paginÄƒ este adresatÄƒ celor care au nevoie de ajutor din partea comunitÄƒÈ›ii â€” timpul de rÄƒspuns **nu este garantat**.",
      })
    }
  </p>
  <p class="more_info">
    {
      t({
        en: " Your browser will display a message asking for access to your GPS location. Allow access for the most accurate location.",
        ro: " Browser-ul va afiÈ™a un mesaj pentru a solicita acces la locaÈ›ia ta GPS. ConfirmÄƒ accesul pentru o localizare cÃ¢t mai precisÄƒ.",
      })
    }
  </p>
  <p class="more_info">
    {
      t({
        en: " Fields marked with a * are **mandatory**.",
        ro: " CÃ¢mpurile marcate cu * sunt obligatorii",
      })
    }
  </p>
  <p class="more_info">
    {
      t({
        en: "  After submitting the form, members in your area will be automatically notified by whatsapp!",
        ro: "  DupÄƒ trimiterea formularului, membrii din zona ta vor fi automat notificaÈ›i whatsapp!",
      })
    }
  </p>

  <form id="form-help" class="more_info">
    <div class="row">
      <SelectCounties selected="B" />
      <AndDivider />
      <GeoLocation />
    </div>

    <div class="row">
      <Details />
    </div>

    <!--<div class="row">-->
    <!--  <TermsAndConditions />-->
    <!--</div>-->

    <button type="button" class="btn btn-primary mt-4 w-full">
      {t({ en: "Submit Request", ro: "Trimite Cererea" })}
    </button>
  </form>

  <script client:visible>
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById("form-help");
      console.log("Form found:", form); // âœ… You said this shows up



      form.addEventListener("submit", (e) => {
        e.preventDefault();
        console.log("ðŸŽ¯ Submit event fired!"); // <-- should appear when you click
        const formData = new FormData(form);
        console.log(formData);
        // console.log("County:", formData.get("county"));
        // console.log("Details:", formData.get("details"));
      });
    });
  </script>

  <style>
    #form-help {
      padding: 1rem;
      margin-bottom: 100px;
    }

    .row {
      margin-top: 2rem;
      border-left: 2px solid var(--color-theme);
      padding-left: 0.5rem;
    }

    .more_info {
      display: block; /* keep layout consistent */
      margin: 0;
      text-align: justify;
      font-size: 0.7rem;
    }

    .accordion {
      max-height: 0;
      opacity: 0;
      overflow: hidden;
      transition:
        max-height 0.5s ease,
        opacity 0.5s ease;
    }

    .accordion.show {
      max-height: 100rem; /* pick a value bigger than your content */
      opacity: 1;
    }

    .btn-primary {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.5rem 1.25rem;
      border: none;
      border-radius: 0.5rem; /* rounded-2xl vibes */
      background-color: blue;
      color: #fff;
      font-weight: 500;
      font-size: 1rem;
      line-height: 1.5;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
      margin-top: 2rem;
    }

    .btn-primary:hover {
      background-color: #1d4ed8; /* blue-700 */
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.12);
    }

    .btn-primary:focus {
      outline: 2px solid #3b82f6; /* blue-500 ring */
      outline-offset: 2px;
    }

    .btn-primary:disabled,
    .btn-primary[disabled] {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .hidden {
      display: none;
    }
  </style>


</div>
